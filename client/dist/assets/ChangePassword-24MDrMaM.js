import{d as E,r as o,a as C,u as k,j as e,Q as F,B as d}from"./index-XFzRIb6l.js";const O=()=>{const x=E(),[r,T]=o.useState({oldPassword:"",newPassword:"",confirmPassword:"",otpNumber:""}),{isLoading:b}=C(s=>s.userAuth),[j,v]=o.useState(!1),[i,N]=o.useState(""),[P,c]=o.useState(!1),h=k(),[n,f]=o.useState(1),[a,u]=o.useState(59),[y,p]=o.useState(!1),S=async s=>{s.preventDefault();const t=s.target;if(r.oldPassword=t[0].value,t[1].value){if(r.newPassword=t[1].value,r.confirmPassword=t[2].value,t[1].value!==t[2].value){c(!0);return}i!==""&&(r.otpNumber=i,r.oldPassword="")}else{if(r.newPassword=t[2].value,r.confirmPassword=t[3].value,t[2].value!==t[3].value){c(!0);return}i!==""&&(r.otpNumber=i,r.oldPassword="")}try{const l=await x.post("/change-password",r,{withCredentials:!0});l.data.status==="success"?(d(l.data.message),setTimeout(()=>{l.data.role==="mentee"&&h("/managment"),l.data.role==="mentor"&&h("/mentor/profile")},1e3)):d.error(l.data.message)}catch(l){const m=l.response;(m==null?void 0:m.status)===401?p(!0):d.error("Please Try Again")}},g=async()=>{try{const s=await x.post("/profile/changePassword/sendOTP",{withCredentials:!0});s.data.status==="success"?(v(!0),f(1),u(30),d(s.data.message)):d.error(s.data.message)}catch(s){console.log(s);const t=s.response;(t==null?void 0:t.status)===404?d.error("Email not found"):d.error("Somehing went Wrong")}},w=()=>{c(!1)};return o.useEffect(()=>{const s=setInterval(()=>{a>0&&u(a-1),a===0&&(n===0?clearInterval(s):(u(59),f(n-1)))},1e3);return()=>{clearInterval(s)}},[a,n]),e.jsxs(e.Fragment,{children:[e.jsx(F,{}),b?e.jsx("h1",{children:"Loading..."}):e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"mt-12 overflow-y-auto overflow-x-hidden flex justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full",children:e.jsxs("div",{className:"relative p-4 w-full max-w-md max-h-full",children:[y===!0?e.jsx("div",{children:e.jsx("h1",{className:"text-center py-1 text-red-500",children:"Incorrect current password"})}):"",e.jsxs("div",{className:"relative rounded-lg shadow-lg border-2",children:[e.jsx("div",{className:"flex items-center justify-center p-4 md:p-5 border-b rounded-t",children:e.jsx("h3",{className:"text-xl font-semibold",children:"Change Password"})}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs("form",{className:"space-y-4",onSubmit:S,children:[j===!1?e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Enter the current password"}),e.jsx("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5",required:!0,onChange:()=>{p(!1)}}),e.jsx("div",{className:"flex justify-between mt-2",children:e.jsx("a",{className:"text-sm text-blue-700 hover:underline dark:text-blue-500",onClick:g,children:"Forgot Password?"})}),e.jsx("hr",{className:"mt-4"})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Enter the OTP Send to Email"}),e.jsx("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5",required:!0,value:i,onChange:s=>N(s.target.value)}),e.jsxs("div",{className:"countdown-text",children:[a>0||n>0?e.jsxs("p",{children:["Time Remaining:"," ",e.jsxs("span",{style:{fontWeight:600},children:[n<10?`0${n}`:n,":",a<10?`0${a}`:a]})]}):e.jsx("p",{children:"Didn't receive code?"}),e.jsx("button",{disabled:a>0||n>0,style:{color:a>0||n>0?"#DFE3E8":"#FF5630"},onClick:g,children:"Resend OTP"})]}),e.jsx("hr",{className:"mt-4"})]}),e.jsxs("div",{children:[P===!0?e.jsx("h1",{className:"text-red-600 text-sm",children:"Password is not matching"}):"",e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"New Password"}),e.jsx("input",{type:"text",className:"bg-gray-50 border border-gray-300 text-sm rounded-lg block w-full p-2.5",required:!0,onChange:w})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Confirm New Password"}),e.jsx("input",{type:"text",className:"bg-gray-50 border border-gray-300 text-sm rounded-lg block w-full p-2.5",required:!0,onChange:w})]}),e.jsx("button",{type:"submit",className:"w-full text-white bg-color-one focus:ring-4 focus:outline-none font-medium rounded-lg text-sm px-5 py-2.5 text-center ",children:"Change"})]})})]})]})})]})};export{O as default};
