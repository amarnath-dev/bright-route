import{d as E,r as d,u as j,e as r,j as e,Q as T,F as v,B as i}from"./index-KMt4GyZR.js";const D=()=>{const f=E(),[a,I]=d.useState({oldPassword:"",newPassword:"",confirmPassword:"",otpNumber:""}),[N,y]=d.useState(!1),[c,P]=d.useState(""),[S,u]=d.useState(!1),g=j(),[n,w]=d.useState(1),[l,m]=d.useState(59),[C,b]=d.useState(!1),k=async t=>{t.preventDefault();const s=t.target;if(a.oldPassword=s[0].value,s[1].value){if(a.newPassword=s[1].value,a.confirmPassword=s[2].value,s[1].value!==s[2].value){u(!0);return}c!==""&&(a.otpNumber=c,a.oldPassword="")}else{if(a.newPassword=s[2].value,a.confirmPassword=s[3].value,s[2].value!==s[3].value){u(!0);return}c!==""&&(a.otpNumber=c,a.oldPassword="")}try{const o=await f.post("/change-password",a,{withCredentials:!0});o.data.status==="success"?(i.success(o.data.message),setTimeout(()=>{o.data.role==="mentee"&&g("/managment"),o.data.role==="mentor"&&g("/mentor/profile")},1e3)):i.error(o.data.message)}catch(o){console.log(o);const h=o.response;(h==null?void 0:h.status)===401?b(!0):i.error("Please Try Again")}},x=async()=>{try{const t=await f.post("/profile/changePassword/sendOTP",{withCredentials:!0});t.data.status==="success"?(y(!0),w(1),m(30),i(t.data.message)):i.error(t.data.message)}catch(t){console.log(t);const s=t.response;(s==null?void 0:s.status)===404?i.error("Email not found"):i.error("Somehing went Wrong")}},p=()=>{u(!1)};return d.useEffect(()=>{const t=setInterval(()=>{l>0&&m(l-1),l===0&&(n===0?clearInterval(t):(m(59),w(n-1)))},1e3);return()=>{clearInterval(t)}},[l,n]),r(v,{children:[e(T,{className:"w-40 md:w-80"}),e("div",{className:"w-full h-screen bg-background-two",children:e("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"overflow-y-auto overflow-x-hidden flex justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full",children:e("div",{className:"relative p-4 w-full max-w-md max-h-full",children:r("div",{className:"relative rounded-lg shadow-lg border",children:[e("div",{className:"flex items-center justify-center p-4 md:p-5 border-b rounded-t",children:e("h3",{className:"text-xl font-semibold text-white",children:"Change Password"})}),e("div",{className:"p-4 md:p-5",children:r("form",{className:"space-y-4",onSubmit:k,children:[N===!1?r("div",{children:[e("label",{className:"block mb-2 text-sm font-medium text-white",children:"Enter the current password"}),e("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5 bg-gray-800 border-gray-900 text-white",required:!0,onChange:()=>{b(!1)}}),r("div",{className:"flex justify-between mt-2",children:[e("a",{className:"text-sm text-blue-700 hover:underline dark:text-blue-500",onClick:x,children:"Forgot Password?"}),C===!0?e(v,{children:e("h1",{className:"text-red-500",children:"Incorrect current password"})}):""]}),e("hr",{className:"mt-4"})]}):r("div",{children:[e("label",{className:"block mb-2 text-sm font-medium text-gray-400",children:"Enter the OTP Send to Email"}),e("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5 bg-gray-800 text-white",required:!0,value:c,onChange:t=>P(t.target.value)}),r("div",{className:"countdown-text",children:[l>0||n>0?r("p",{className:"text-gray-300",children:["Time Remaining:"," ",r("span",{style:{fontWeight:600},children:[n<10?`0${n}`:n,":",l<10?`0${l}`:l]})]}):e("p",{className:"text-gray-400",children:"Didn't receive code?"}),e("button",{className:"text-gray-400",disabled:l>0||n>0,style:{color:(l>0||n>0,"#rgb(156 163 175)")},onClick:x,children:"Resend OTP"})]}),e("hr",{className:"mt-4"})]}),r("div",{children:[S===!0?e("h1",{className:"text-red-600 text-sm",children:"Password is not matching"}):"",e("label",{className:"block mb-2 text-sm font-medium text-white",children:"New Password"}),e("input",{type:"text",className:"bg-gray-800 border border-gray-900 text-white rounded-lg block w-full p-2.5",required:!0,onChange:p})]}),r("div",{children:[e("label",{className:"block mb-2 text-sm font-medium text-white",children:"Confirm New Password"}),e("input",{type:"text",className:"border-gray-900 border bg-gray-800 text-white text-sm rounded-lg block w-full p-2.5",required:!0,onChange:p})]}),e("button",{type:"submit",className:"w-full text-white bg-color-five focus:ring-4 focus:outline-none font-medium rounded-lg text-sm px-5 py-2.5 text-center ",children:"Change"})]})})]})})})})]})};export{D as default};
