import{d as S,r as o,u as C,j as e,Q as k,B as d}from"./index-g0sAwdL0.js";const O=()=>{const x=S(),[r,E]=o.useState({oldPassword:"",newPassword:"",confirmPassword:"",otpNumber:""}),[p,v]=o.useState(!1),[c,j]=o.useState(""),[N,i]=o.useState(!1),h=C(),[n,f]=o.useState(1),[a,u]=o.useState(59),[y,g]=o.useState(!1),P=async s=>{s.preventDefault();const t=s.target;if(r.oldPassword=t[0].value,t[1].value){if(r.newPassword=t[1].value,r.confirmPassword=t[2].value,t[1].value!==t[2].value){i(!0);return}c!==""&&(r.otpNumber=c,r.oldPassword="")}else{if(r.newPassword=t[2].value,r.confirmPassword=t[3].value,t[2].value!==t[3].value){i(!0);return}c!==""&&(r.otpNumber=c,r.oldPassword="")}try{const l=await x.post("/change-password",r,{withCredentials:!0});l.data.status==="success"?(d.success(l.data.message),setTimeout(()=>{l.data.role==="mentee"&&h("/managment"),l.data.role==="mentor"&&h("/mentor/profile")},1e3)):d.error(l.data.message)}catch(l){console.log(l);const m=l.response;(m==null?void 0:m.status)===401?g(!0):d.error("Please Try Again")}},w=async()=>{try{const s=await x.post("/profile/changePassword/sendOTP",{withCredentials:!0});s.data.status==="success"?(v(!0),f(1),u(30),d(s.data.message)):d.error(s.data.message)}catch(s){console.log(s);const t=s.response;(t==null?void 0:t.status)===404?d.error("Email not found"):d.error("Somehing went Wrong")}},b=()=>{i(!1)};return o.useEffect(()=>{const s=setInterval(()=>{a>0&&u(a-1),a===0&&(n===0?clearInterval(s):(u(59),f(n-1)))},1e3);return()=>{clearInterval(s)}},[a,n]),e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-40 md:w-80"}),e.jsx("div",{className:"w-full h-screen bg-background-two",children:e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"overflow-y-auto overflow-x-hidden flex justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full",children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative rounded-lg shadow-lg border",children:[e.jsx("div",{className:"flex items-center justify-center p-4 md:p-5 border-b rounded-t",children:e.jsx("h3",{className:"text-xl font-semibold text-gray-400",children:"Change Password"})}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs("form",{className:"space-y-4",onSubmit:P,children:[p===!1?e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-400",children:"Enter the current password"}),e.jsx("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5 bg-gray-800 border-gray-900 text-white",required:!0,onChange:()=>{g(!1)}}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("a",{className:"text-sm text-blue-700 hover:underline dark:text-blue-500",onClick:w,children:"Forgot Password?"}),y===!0?e.jsx(e.Fragment,{children:e.jsx("h1",{className:"text-red-500",children:"Incorrect current password"})}):""]}),e.jsx("hr",{className:"mt-4"})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-400",children:"Enter the OTP Send to Email"}),e.jsx("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5 bg-gray-800 text-white",required:!0,value:c,onChange:s=>j(s.target.value)}),e.jsxs("div",{className:"countdown-text",children:[a>0||n>0?e.jsxs("p",{className:"text-gray-300",children:["Time Remaining:"," ",e.jsxs("span",{style:{fontWeight:600},children:[n<10?`0${n}`:n,":",a<10?`0${a}`:a]})]}):e.jsx("p",{className:"text-gray-400",children:"Didn't receive code?"}),e.jsx("button",{className:"text-gray-400",disabled:a>0||n>0,style:{color:(a>0||n>0,"#rgb(156 163 175)")},onClick:w,children:"Resend OTP"})]}),e.jsx("hr",{className:"mt-4"})]}),e.jsxs("div",{children:[N===!0?e.jsx("h1",{className:"text-red-600 text-sm",children:"Password is not matching"}):"",e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-400",children:"New Password"}),e.jsx("input",{type:"text",className:"bg-gray-800 border border-gray-900 text-white rounded-lg block w-full p-2.5",required:!0,onChange:b})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-400",children:"Confirm New Password"}),e.jsx("input",{type:"text",className:"border-gray-900 border bg-gray-800 text-white text-sm rounded-lg block w-full p-2.5",required:!0,onChange:b})]}),e.jsx("button",{type:"submit",className:"w-full text-white bg-color-five focus:ring-4 focus:outline-none font-medium rounded-lg text-sm px-5 py-2.5 text-center ",children:"Change"})]})})]})})})})]})};export{O as default};
