import{x as b,r as _,u as z,a as g,p as k,d as R,j as d,w as P,t as C,v as N,q as D}from"./index-g0sAwdL0.js";import{l as S}from"./index-CUx-uIXr.js";var v={},E=b&&b.__awaiter||function(u,t,a,r){function n(o){return o instanceof a?o:new a(function(e){e(o)})}return new(a||(a=Promise))(function(o,e){function s(i){try{c(r.next(i))}catch(l){e(l)}}function p(i){try{c(r.throw(i))}catch(l){e(l)}}function c(i){i.done?o(i.value):n(i.value).then(s,p)}c((r=r.apply(u,t||[])).next())})};Object.defineProperty(v,"__esModule",{value:!0});const m=_;class T{constructor(t){this.options=t,typeof window<"u"&&(this.rzrpayInstannce=new window.Razorpay(this.options))}on(t,a){this.rzrpayInstannce.on(t,a)}open(){this.rzrpayInstannce.open()}}const O=()=>{const u="https://checkout.razorpay.com/v1/checkout.js",t=(0,m.useMemo)(()=>typeof window<"u",[]),[a,r]=(0,m.useState)(!1),n=(0,m.useCallback)(()=>!(!t||!("Razorpay"in window)),[]),o=(0,m.useCallback)(e=>{if(t)return new Promise((s,p)=>{const c=document.createElement("script");c.src=e,c.onload=i=>{r(!0),s(i)},c.onerror=i=>p(i),document.body.appendChild(c)})},[]);return(0,m.useEffect)(()=>{n()||E(void 0,void 0,void 0,function*(){try{yield o(u)}catch(e){throw new Error(e)}})},[]),[T,a]};var M=v.default=O;const F=()=>{const u=z(),{user:t}=g(l=>l.userAuth),a=k(),r=_.useRef(null);_.useEffect(()=>{r.current=S("ws:https://bright-route.online")},[]);const{form:n,planId:o,mentorId:e,planAmount:s}=g(l=>l.applySlice),p=R(),[c]=M(),i=_.useCallback(()=>{const l={key:"rzp_test_b79hbKESuzK5D3",amount:parseInt((s==null?void 0:s.plan_amount)||"0",10)*100,currency:"INR",name:"Bright Route",description:"Test Transaction",image:"https://t3.ftcdn.net/jpg/02/17/18/84/360_F_217188426_smgwnDFnQC5DHQ8mKGkdsMO7oDDP5nZn.jpg",handler:j=>{(async()=>{var y,f;try{const h={razorPay_id:j.razorpay_payment_id,mentor_id:e==null?void 0:e.mentor_id,mentor_plan_id:o==null?void 0:o.mentor_plan_id,mentee_id:t==null?void 0:t._id,mentor_plan_amount:s==null?void 0:s.plan_amount,goal_of_mentorship:n==null?void 0:n.mentorship_goal,time_to_reach_goal:n==null?void 0:n.time_to_reach,message_to_mentor:n==null?void 0:n.message_to_mentor};if((await p.post("/payment-suceess",h,{withCredentials:!0})).data.status==="success"){const w="Payment Completed Successfully 🤝",x=`${t==null?void 0:t.first_name} has purchased your mentorship plan!🎉`;await p.post("/notification/paymentMessage",{text:w},{withCredentials:!0}),await p.post(`/notification/mentorNotification/${e==null?void 0:e.mentor_id}`,{mentorText:x},{withCredentials:!0}),(y=r.current)==null||y.emit("sendNotification",{senderId:t==null?void 0:t._id,receiverId:t==null?void 0:t._id,content:w,type:"mentee"}),(f=r.current)==null||f.emit("sendNotification",{senderId:t==null?void 0:t._id,receiverId:e==null?void 0:e.mentor_id,content:x,type:"mentor"}),a(P(null)),a(C(null)),a(N(null)),a(D(null)),u(`/mentor-profile/apply/checkout/success/${e==null?void 0:e.mentor_id}`)}}catch(h){console.log(h)}})()},prefill:{mentee_id:t==null?void 0:t._id,name:t==null?void 0:t.first_name,email:t==null?void 0:t.email},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}};new c(l).open()},[c,p,a,n==null?void 0:n.mentorship_goal,n==null?void 0:n.message_to_mentor,n==null?void 0:n.time_to_reach,e==null?void 0:e.mentor_id,u,s==null?void 0:s.plan_amount,o==null?void 0:o.mentor_plan_id,t==null?void 0:t._id,t==null?void 0:t.email,t==null?void 0:t.first_name]);return d.jsx("div",{className:"w-full h-screen flex justify-center py-20 bg-background-two",children:d.jsxs("div",{className:"text-gray-400 flex flex-col",children:[d.jsx("li",{className:"py-3",children:"Please make sure that you have a stable internet connection"}),d.jsx("li",{className:"py-3",children:"Do not close or cancel the window during the Transactions"}),d.jsx("li",{className:"py-3",children:"Once you payment is completed you can check the payment details"}),d.jsx("div",{className:"w-full flex justify-center py-10",children:d.jsx("button",{onClick:i,className:"border px-6 py-2 rounded-sm text-white bg-black",children:"Proceed to Transaction"})})]})})},Z=()=>d.jsx("div",{children:d.jsx(F,{})});export{Z as default};
