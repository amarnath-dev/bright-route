import{c as b,r as h,S as z,u as C,a as v,h as P,d as R,j as d,i as N,k,l as D,m as S}from"./index-86Yayage.js";var g={},T=b&&b.__awaiter||function(c,r,t,i){function n(a){return a instanceof t?a:new t(function(e){e(a)})}return new(t||(t=Promise))(function(a,e){function o(s){try{l(i.next(s))}catch(p){e(p)}}function u(s){try{l(i.throw(s))}catch(p){e(p)}}function l(s){s.done?a(s.value):n(s.value).then(o,u)}l((i=i.apply(c,r||[])).next())})};Object.defineProperty(g,"__esModule",{value:!0});const m=h;class E{constructor(r){this.options=r,typeof window<"u"&&(this.rzrpayInstannce=new window.Razorpay(this.options))}on(r,t){this.rzrpayInstannce.on(r,t)}open(){this.rzrpayInstannce.open()}}const O=()=>{const c="https://checkout.razorpay.com/v1/checkout.js",r=(0,m.useMemo)(()=>typeof window<"u",[]),[t,i]=(0,m.useState)(!1),n=(0,m.useCallback)(()=>!(!r||!("Razorpay"in window)),[]),a=(0,m.useCallback)(e=>{if(r)return new Promise((o,u)=>{const l=document.createElement("script");l.src=e,l.onload=s=>{i(!0),o(s)},l.onerror=s=>u(s),document.body.appendChild(l)})},[]);return(0,m.useEffect)(()=>{n()||T(void 0,void 0,void 0,function*(){try{yield a(c)}catch(e){throw new Error(e)}})},[]),[E,t]};var M=g.default=O;const F=()=>{const c=h.useContext(z),r=C(),{user:t}=v(p=>p.userAuth),i=P(),{form:n,planId:a,mentorId:e,planAmount:o}=v(p=>p.applySlice),u=R(),[l]=M(),s=h.useCallback(()=>{const p={key:"rzp_test_b79hbKESuzK5D3",amount:parseInt((o==null?void 0:o.plan_amount)||"0",10)*100,currency:"INR",name:"Bright Route",description:"Test Transaction",image:"https://t3.ftcdn.net/jpg/02/17/18/84/360_F_217188426_smgwnDFnQC5DHQ8mKGkdsMO7oDDP5nZn.jpg",handler:j=>{(async()=>{var y,f;try{const _={razorPay_id:j.razorpay_payment_id,mentor_id:e==null?void 0:e.mentor_id,mentor_plan_id:a==null?void 0:a.mentor_plan_id,mentee_id:t==null?void 0:t._id,mentor_plan_amount:o==null?void 0:o.plan_amount,goal_of_mentorship:n==null?void 0:n.mentorship_goal,time_to_reach_goal:n==null?void 0:n.time_to_reach,message_to_mentor:n==null?void 0:n.message_to_mentor};if((await u.post("/payment-suceess",_,{withCredentials:!0})).data.status==="success"){const w="Payment Completed Successfully 🤝",x=`${t==null?void 0:t.first_name} has purchased your mentorship plan!🎉`;await u.post("/notification/paymentMessage",{text:w},{withCredentials:!0}),await u.post(`/notification/mentorNotification/${e==null?void 0:e.mentor_id}`,{mentorText:x},{withCredentials:!0}),(y=c==null?void 0:c.current)==null||y.emit("sendNotification",{senderId:t==null?void 0:t._id,receiverId:t==null?void 0:t._id,content:w,type:"mentee"}),(f=c==null?void 0:c.current)==null||f.emit("sendNotification",{senderId:t==null?void 0:t._id,receiverId:e==null?void 0:e.mentor_id,content:x,type:"mentor"}),i(N(null)),i(k(null)),i(D(null)),i(S(null)),r(`/mentor-profile/apply/checkout/success/${e==null?void 0:e.mentor_id}`)}}catch(_){console.log(_)}})()},prefill:{mentee_id:t==null?void 0:t._id,name:t==null?void 0:t.first_name,email:t==null?void 0:t.email},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}};new l(p).open()},[l,u,i,n==null?void 0:n.mentorship_goal,n==null?void 0:n.message_to_mentor,n==null?void 0:n.time_to_reach,e==null?void 0:e.mentor_id,r,o==null?void 0:o.plan_amount,a==null?void 0:a.mentor_plan_id,t==null?void 0:t._id,t==null?void 0:t.email,t==null?void 0:t.first_name]);return d.jsx("div",{className:"w-full h-screen flex justify-center py-20 bg-background-two",children:d.jsxs("div",{className:"text-white text-lg flex flex-col px-5 text-wrap",children:[d.jsx("li",{className:"py-3",children:"Please make sure that you have a stable internet connection"}),d.jsx("li",{className:"py-3",children:"Do not close or cancel the window during the Transaction"}),d.jsx("li",{className:"py-3",children:"Once you payment is completed you can check the payment details"}),d.jsx("li",{className:"py-3 font-bold",children:"Your Plan will be valid for 30 days starting from the purchase Date"}),d.jsx("div",{className:"w-full flex justify-center py-10",children:d.jsx("button",{onClick:s,className:"border px-6 py-2 rounded-sm text-white bg-color-five",children:"Proceed to Transaction"})})]})})},Q=()=>d.jsx("div",{children:d.jsx(F,{})});export{Q as default};
