import{c as v,r as _,S as P,u as C,a as b,h as N,d as R,j as p,e as k,i as j,k as D,l as S,m as T}from"./index-yrz5zUaW.js";var z={},O=v&&v.__awaiter||function(c,r,e,s){function n(a){return a instanceof e?a:new e(function(t){t(a)})}return new(e||(e=Promise))(function(a,t){function o(i){try{l(s.next(i))}catch(d){t(d)}}function u(i){try{l(s.throw(i))}catch(d){t(d)}}function l(i){i.done?a(i.value):n(i.value).then(o,u)}l((s=s.apply(c,r||[])).next())})};Object.defineProperty(z,"__esModule",{value:!0});const m=_;class Y{constructor(r){this.options=r,typeof window<"u"&&(this.rzrpayInstannce=new window.Razorpay(this.options))}on(r,e){this.rzrpayInstannce.on(r,e)}open(){this.rzrpayInstannce.open()}}const E=()=>{const c="https://checkout.razorpay.com/v1/checkout.js",r=(0,m.useMemo)(()=>typeof window<"u",[]),[e,s]=(0,m.useState)(!1),n=(0,m.useCallback)(()=>!(!r||!("Razorpay"in window)),[]),a=(0,m.useCallback)(t=>{if(r)return new Promise((o,u)=>{const l=document.createElement("script");l.src=t,l.onload=i=>{s(!0),o(i)},l.onerror=i=>u(i),document.body.appendChild(l)})},[]);return(0,m.useEffect)(()=>{n()||O(void 0,void 0,void 0,function*(){try{yield a(c)}catch(t){throw new Error(t)}})},[]),[Y,e]};var M=z.default=E;const L=()=>{const c=_.useContext(P),r=C(),{user:e}=b(d=>d.userAuth),s=N(),{form:n,planId:a,mentorId:t,planAmount:o}=b(d=>d.applySlice),u=R(),[l]=M(),i=_.useCallback(()=>{const d={key:"rzp_test_d4DYYP3DeZhYXu",amount:parseInt((o==null?void 0:o.plan_amount)||"0",10)*100,currency:"INR",name:"Bright Route",description:"Test Transaction",handler:g=>{(async()=>{var y,f;try{const h={razorPay_id:g.razorpay_payment_id,mentor_id:t==null?void 0:t.mentor_id,mentor_plan_id:a==null?void 0:a.mentor_plan_id,mentee_id:e==null?void 0:e._id,mentor_plan_amount:o==null?void 0:o.plan_amount,goal_of_mentorship:n==null?void 0:n.mentorship_goal,time_to_reach_goal:n==null?void 0:n.time_to_reach,message_to_mentor:n==null?void 0:n.message_to_mentor};if((await u.post("/payment-suceess",h,{withCredentials:!0})).data.status==="success"){const w="Payment Completed Successfully ðŸ¤",x=`${e==null?void 0:e.first_name} has purchased your mentorship plan!ðŸŽ‰`;await u.post("/notification/paymentMessage",{text:w},{withCredentials:!0}),await u.post(`/notification/mentorNotification/${t==null?void 0:t.mentor_id}`,{mentorText:x},{withCredentials:!0}),(y=c==null?void 0:c.current)==null||y.emit("sendNotification",{senderId:e==null?void 0:e._id,receiverId:e==null?void 0:e._id,content:w,type:"mentee"}),(f=c==null?void 0:c.current)==null||f.emit("sendNotification",{senderId:e==null?void 0:e._id,receiverId:t==null?void 0:t.mentor_id,content:x,type:"mentor"}),s(j(null)),s(D(null)),s(S(null)),s(T(null)),r(`/mentor-profile/apply/checkout/success/${t==null?void 0:t.mentor_id}`)}}catch(h){console.log(h)}})()},prefill:{mentee_id:e==null?void 0:e._id,name:e==null?void 0:e.first_name,email:e==null?void 0:e.email},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}};new l(d).open()},[l,u,s,n==null?void 0:n.mentorship_goal,n==null?void 0:n.message_to_mentor,n==null?void 0:n.time_to_reach,t==null?void 0:t.mentor_id,r,o==null?void 0:o.plan_amount,a==null?void 0:a.mentor_plan_id,e==null?void 0:e._id,e==null?void 0:e.email,e==null?void 0:e.first_name]);return p("div",{className:"w-full h-screen flex justify-center py-20 bg-background-two",children:k("div",{className:"text-white text-lg flex flex-col px-5 text-wrap",children:[p("li",{className:"py-3",children:"Please make sure that you have a stable internet connection"}),p("li",{className:"py-3",children:"Do not close or cancel the window during the Transaction"}),p("li",{className:"py-3",children:"Once you payment is completed you can check the payment details"}),p("li",{className:"py-3 font-bold",children:"Your Plan will be valid for 30 days starting from the purchase Date"}),p("div",{className:"w-full flex justify-center py-10",children:p("button",{onClick:i,className:"border px-6 py-2 rounded-sm text-white bg-color-five",children:"Proceed to Transaction"})})]})})},F=()=>p("div",{children:p(L,{})});export{F as default};
