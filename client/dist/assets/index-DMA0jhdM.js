import{d as E,r as i,u as O,e as a,j as e,Q as T,F as N,B as l}from"./index-wzvDMfSu.js";import{S as I}from"./sweetalert2.all-kwD5x_v1.js";const $=()=>{const h=E(),[t,j]=i.useState({oldPassword:"",newPassword:"",confirmPassword:"",otpNumber:""}),[v,P]=i.useState(!1),[c,y]=i.useState(""),[S,m]=i.useState(!1),f=O(),[d,g]=i.useState(1),[o,u]=i.useState(59),[C,p]=i.useState(!1),k=async s=>{s.preventDefault();const n=s.target;if(t.oldPassword=n[0].value,n[1].value){if(t.newPassword=n[1].value,t.confirmPassword=n[2].value,t.newPassword=t.newPassword.replace(/\s/g,""),t.confirmPassword=t.confirmPassword.replace(/\s/g,""),t.newPassword!==t.confirmPassword){m(!0);return}if(c!==""){const r=c.replace(/\s/g,"");if(r.length===4)t.otpNumber=r,t.oldPassword="";else{l.error("Invalid OTP Number");return}}}else{if(t.newPassword=n[2].value,t.confirmPassword=n[3].value,t.newPassword=t.newPassword.replace(/\s/g,""),t.confirmPassword=t.confirmPassword.replace(/\s/g,""),t.newPassword!==t.confirmPassword){m(!0);return}if(c!==""){const r=c.replace(/\s/g,"");if(r.length===4)t.otpNumber=r,t.oldPassword="";else{l.error("Invalid OTP Number");return}}}if(t.oldPassword===t.newPassword){I.fire({title:"Choose a different password",text:"New password must be different from old password"});return}if(!new RegExp(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/).test(t.confirmPassword)){l.error("Password must meet the validation criterias");return}try{const r=await h.post("/change-password",t,{withCredentials:!0});r.data.status==="success"?(l.success(r.data.message),setTimeout(()=>{r.data.role==="mentee"&&f("/managment"),r.data.role==="mentor"&&f("/mentor/profile")},1e3)):l.error(r.data.message)}catch(r){console.log(r);const w=r.response;(w==null?void 0:w.status)===401?p(!0):l.error("Please Try Again")}},x=async()=>{try{const s=await h.post("/profile/changePassword/sendOTP",{withCredentials:!0});s.data.status==="success"?(P(!0),g(1),u(30),l(s.data.message)):l.error(s.data.message)}catch(s){console.log(s);const n=s.response;(n==null?void 0:n.status)===404?l.error("Email not found"):l.error("Somehing went Wrong")}},b=()=>{m(!1)};return i.useEffect(()=>{const s=setInterval(()=>{o>0&&u(o-1),o===0&&(d===0?clearInterval(s):(u(59),g(d-1)))},1e3);return()=>{clearInterval(s)}},[o,d]),a(N,{children:[e(T,{className:"w-40 md:w-80"}),e("div",{className:"w-full h-screen bg-background-two",children:e("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"overflow-y-auto overflow-x-hidden flex justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full",children:e("div",{className:"relative p-4 w-full max-w-md max-h-full",children:a("div",{className:"relative rounded-lg shadow-lg border",children:[e("div",{className:"flex items-center justify-center p-4 md:p-5 border-b rounded-t",children:e("h3",{className:"text-xl font-semibold text-white",children:"Change Password"})}),e("div",{className:"p-4 md:p-5",children:a("form",{className:"space-y-4",onSubmit:k,children:[v===!1?a("div",{children:[e("label",{className:"block mb-2 text-sm font-medium text-white",children:"Enter the current password"}),e("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5 bg-gray-800 border-gray-900 text-white",required:!0,onChange:()=>{p(!1)}}),a("div",{className:"flex justify-between mt-2",children:[e("a",{className:"text-sm text-blue-700 hover:underline dark:text-blue-500",onClick:x,children:"Forgot Password?"}),C===!0?e(N,{children:e("h1",{className:"text-red-500",children:"Incorrect current password"})}):""]}),e("hr",{className:"mt-4"})]}):a("div",{children:[e("label",{className:"block mb-2 text-sm font-medium text-gray-400",children:"Enter the OTP Send to Email"}),e("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5 bg-gray-800 text-white",required:!0,value:c,onChange:s=>y(s.target.value)}),a("div",{className:"countdown-text",children:[o>0||d>0?a("p",{className:"text-gray-300",children:["Time Remaining:"," ",a("span",{style:{fontWeight:600},children:[d<10?`0${d}`:d,":",o<10?`0${o}`:o]})]}):e("p",{className:"text-gray-400",children:"Didn't receive code?"}),e("button",{className:"text-gray-400",disabled:o>0||d>0,style:{color:(o>0||d>0,"#rgb(156 163 175)")},onClick:x,children:"Resend OTP"})]}),e("hr",{className:"mt-4"})]}),a("div",{children:[S===!0?e("h1",{className:"text-red-600 text-sm",children:"Password is not matching"}):"",e("label",{className:"block mb-2 text-sm font-medium text-white",children:"New Password"}),e("input",{type:"text",className:"bg-gray-800 border border-gray-900 text-white rounded-lg block w-full p-2.5",required:!0,onChange:b})]}),a("div",{children:[e("label",{className:"block mb-2 text-sm font-medium text-white",children:"Confirm New Password"}),e("input",{type:"text",className:"border-gray-900 border bg-gray-800 text-white text-sm rounded-lg block w-full p-2.5",required:!0,onChange:b}),a("div",{className:"py-2",children:[e("span",{className:"text-white",children:"Password must have :"}),a("div",{className:"",children:[e("li",{className:"text-white text-md",children:"Atleast 8 characters long"}),e("li",{className:"text-white text-md",children:"One uppercase and Lowercase letter"}),e("li",{className:"text-white text-md",children:"One Number and Special Character"})]})]})]}),e("button",{type:"submit",className:"w-full text-white bg-color-five focus:ring-4 focus:outline-none font-medium rounded-lg text-sm px-5 py-2.5 text-center ",children:"Change"})]})})]})})})})]})};export{$ as default};
